<div class="search-popup" [class.is-visible]="true" (click)="onBackdropClick($event)">
  <div class="search-popup-content">
    <div class="search-popup-header">
      <h3>Search Products</h3>
      <button class="btn-close-search" (click)="closeSearch()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    
    <form [formGroup]="searchForm" class="search-form">
      <div class="search-input-group">
        <input 
          type="text" 
          formControlName="query" 
          placeholder="Search for products..."
          class="form-control"
          autofocus
        >
        <button type="button" class="search-btn">
          <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
          </svg>
        </button>
      </div>
    </form>

    <div class="search-results" *ngIf="searchResults.length > 0">
      <div class="search-results-header">
        <h4>Search Results ({{ searchResults.length }})</h4>
      </div>
      <div class="search-results-list">
        <div 
          class="search-result-item" 
          *ngFor="let product of searchResults"
          (click)="selectProduct(product)"
        >
          <img [src]="product.image" [alt]="product.name" class="product-image">
          <div class="product-info">
            <h5 class="product-name">{{ product.name }}</h5>
            <p class="product-price">${{ product.price }}</p>
            <p class="product-category">{{ product.category }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="no-results" *ngIf="searchForm.get('query')?.value && searchForm.get('query')?.value.length > 2 && searchResults.length === 0 && !isSearching">
      <p>No products found for "{{ searchForm.get('query')?.value }}"</p>
    </div>

    <div class="search-loading" *ngIf="isSearching">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Searching...</span>
      </div>
    </div>
  </div>
</div>
